#!/bin/bash


echo -ne "4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA
4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA
4qCA4qCA4qCA4qCA4qOA4qGA4qCA4qCA4qCA4qKA4qKA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA
4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCACuKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKg
gOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKigOKjoOKj
pOKjtOKjtuKjtuKjtuKjpuKjpOKjpOKjpOKjpOKjtuKjvuKjv+Kjv+Kjv+Khl+KgsuKgsuKgv+Kg
v+Kgv+Kgt+KgpuKgpOKjpOKhgOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggAriooDio6Ti
o7bio6bioKTioKTio4Tio4Dio4Dio4Dio4DioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDi
oIDioIDioIDioIDioIDioqDioJ/iooniob3ioJ/ioJvioJvioJvioJvio7viob/ioLfio4TioIji
or/ioIDioLjioYbioYfioIDioIDioIDioIDioIDioIDioIDioIDioIjioqfioIDioIDioIDioIDi
oIDioIDioIDioIDioIDioIAK4qC44qO/4qO/4qG/4qCA4qCA4qCA4qCA4qCA4qCA4qCI4qCJ4qCJ
4qCJ4qCZ4qCS4qCS4qCS4qCS4qCg4qCk4qCk4qCk4qOE4qOA4qOw4qOv4qO04qOv4qOk4qOE4qOA
4qOg4qCW4qCL4qCB4qCA4qCA4qK44qCA4qO+4qCA4qKA4qO34qO44qCA4qOk4qOk4qOE4qOg4qO2
4qGE4qO24qOm4qC44qGE4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCACuKggOKgiOKgieKgmeKg
k+KgkuKgkuKgsuKgpOKgpOKgpOKipOKjgOKjgOKjgOKggOKggOKggOKggOKggOKggOKggOKggOKg
gOKggOKggOKgiOKgmeKjv+KjhuKggOKgiOKgs+KhhOKggOKggOKggOKggOKiuOKggOKhh+KggOKi
u+KiueKhgOKggOKjv+KhhOKiu+Kjv+KjhOKju+Kjv+KhmOKjp+Kiu+KggOKggOKggOKggOKggOKg
gOKggOKggOKggArioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDi
oInioInioInioJHioJLioJLioJLioKbio6Tio6Tio6Tio4DiobTio7/ioI/ioIDioIDiooDioIfi
oIDioIDioIDioIDioYbiorjioIfioIDioIjioJvioZ/ioobioJjio6fioIjio7/iornio7viob/i
orfio73ioIjio6fio4Tio4Dio4Dio4Dio4DioIDioIDioIAK4qCA4qCA4qCA4qCA4qCA4qCA4qCA
4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qO04qOL4qOA4qCI
4qO/4qOa4qOT4qOS4qOS4qOa4qOJ4qCy4qOk4qOE4qOA4qOw4qO34qCf4qCA4qCA4qCA4qCA4qK5
4qK44qCA4qCZ4qK/4qOf4qOI4qO/4qCn4qCk4qCd4qCS4qCL4qCJ4qCB4qCA4qCI4qO/4qGE4qCA
4qCACuKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKigOKjpOKgtuKg
tuKituKjv+Kjv+Kjv+Kjv+KjveKjv+Kju+Kjv+Kjv+Kjm+Kju+Kjv+Kiv+Kjv+Kjn+Kjv+Kjv+Kj
v+Kjv+Kjv+KgluKgkuKjsuKjtuKjtuKgvuKgtuKgk+Kgi+KgieKgieKggOKggOKggOKggOKggOKg
gOKggOKggOKggOKggOKggOKimOKhhuKggOKggArioIDioIDioIDioIDioIDioIDioIDioIDioIDi
oIDioIDioIDiooDio7Tiob/ioIHio4Dio7Tio4vioInio7nioYfio6Dio7/ioL/io7/ioZ/ioIni
oInioInioIHioInioInioInioInio5vioZvioJvio7/iopvio7/io7/ioYTioIDioIDioIDioIDi
oIDioIDioIDioIDioIDiooDio4Dio4DioaTioKTiorTio7bio77io5/iob3ioL/ioqTio4AK4qCA
4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qKA4qG04qCL4qCB4qCY4qCb4qK74qO/4qO/4qC1
4qKr4qO+4qG/4qCB4qCA4qO/4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qK64qO/4qO/4qGP4qK5
4qC44qO/4qO/4qOD4qOA4qOg4qOk4qC04qCW4qCS4qCS4qO/4qOP4qOp4qCk4qC+4qK34qOW4qOJ
4qOJ4qOJ4qO34qG24qCW4qKa4qO/CuKggOKggOKggOKigOKjtOKgnuKgieKgieKgieKgieKiieKh
veKgm+Kjs+KhtuKgguKggOKggOKjoOKjvOKhv+Kgi+KggOKggOKggOKjv+KhgOKggOKggOKggOKg
gOKggOKggOKggOKggOKjv+KggeKgieKjv+Khj+KgieKgieKigOKjgOKgrOKiv+KjtuKhkuKgiuKg
ieKgieKimeKjv+KjpuKhpOKglOKgm+Kjv+KgieKigOKjtOKjt+KjvuKjv+KjvwrioIDioIDioIDi
o77ioIHioIDioIDioIDioIDiobDioIvio4Dio7TioZ/ioIHioIDioqDio77io7/io4/io4Dio4Di
o4Dio4Dio4Dio7/ioYfioIDioIDio6DioL7ioJvioInioInioInioJDiopLiob7ioJvioLPio4Ti
oYDioIDioIDioIDio4Dio4nior/iobbioJLioIvioInioIDio7/ioYTio4Dio7Tio7/io77io7/i
o7/io7/io7/io7/iorkK4qCA4qCA4qCA4qK34qOE4qOA4qOA4qOA4qOA4qGH4qO84qO/4qGf4qCA
4qCg4qOk4qCA4qCJ4qCJ4qGJ4qOJ4qGJ4qCJ4qCb4qCb4qC/4qCH4qCA4qOw4qCL4qCA4qCA4qCA
4qCA4qCA4qKg4qCL4qCA4qCA4qKA4qGg4qCd4qK34qCK4qCJ4qCB4qCA4qCA4qOn4qCA4qCA4qOg
4qO04qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qCH4qCACuKggOKggOKggOKggOKiiOKj
v+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+KjjeKgieKgu+KgtuKgtuKjvuKgpuKgpOKgrOKjv+KjhOKj
gOKjvOKjsuKjvuKhv+KggOKggOKggOKggOKggOKggOKhh+KggOKjoOKgnuKiieKjoOKjpOKjvuKj
t+KjtuKjtuKjpuKjpOKjv+KjvuKjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Khv+Kg
n+KggOKggArioIDioIDioIDioIDioJjio7/io7/io7/io7/io7/io7/io7/io6fioInioLPio4Ti
oIDioIDioIDioIDioIDioIDioIDioInioInioJviornio7/ior/io7bio6Tio6Tio6Tio4Tio6Ti
oYHiorDioIPio7Tio7/io7/io7/ioJvio7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/i
o77iob/io7/io7/iob/ioJ/ioInioIDioIDioIDioIAK4qCA4qCA4qCA4qCA4qCA4qCY4qK/4qO/
4qO/4qO/4qO/4qO/4qO/4qO34qO24qO+4qO34qO24qO24qO24qOk4qOk4qOk4qOE4qOA4qOA4qOA
4qCA4qCA4qC54qO/4qO/4qO/4qO/4qO/4qO/4qO/4qO+4qO/4qO/4qK44qO/4qO/4qO/4qO/4qO/
4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qC/4qOv4qO/4qCf4qCJ4qCA4qCA4qCA4qCA4qCA4qCA4qCA
CuKggOKggOKggOKggOKggOKggOKggOKgiOKgm+Kgv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kj
v+Kjv+Khv+Kgn+KgieKggOKggOKggOKgiOKgieKgieKgmeKiv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kj
v+Kjv+Kjv+KjvOKjv+Kiv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kjv+Kgv+Kgi+KggOKg
gOKggOKggOKggOKggOKggOKggOKggOKggArioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDi
oIDioInioInioJvioJvioJvioJvioJvioJvioIHioIDioIDioIDioIDioIDioIDioIDioIDioIDi
oIDioIjioJnioL/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/io7/i
o7/io7/ioJ/ioIvioIHioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIDioIAK4qCA4qCA
4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA
4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCI4qCZ4qC/4qK/4qO/4qO/4qO/
4qO/4qO/4qO/4qO/4qO/4qO/4qO/4qCf4qCL4qCB4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA4qCA
4qCA4qCA4qCA4qCA4qCA4qCACuKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKg
gOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKg
gOKggOKggOKggOKggOKggOKggOKgieKgieKgieKgm+Kgm+Kgu+Kgn+Kgi+KggOKggOKggOKggOKg
gOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggOKggAo=
" | base64 -d

# Define colors
RED='\033[0;31m'
GREEN='\033[0;32m'
YELLOW='\033[1;33m'
BLUE='\033[0;34m'
NC='\033[0m' # No Color

# Define output report file
REPORT_FILE="scan_report_$(date +%F_%H%M%S).txt"

# Define services and ports (Cisco Reverse Telnet omitted as it uses dynamic ports; rusers omitted as it lacks a standard port)
SERVICES=(
    "telnet:23:TCP"
    "ssh:22:TCP"
    "snmp:161:UDP"
    "tftp:69:UDP"
    "ntp:123:UDP"
    "msrpc:135:TCP,UDP"
    "netbios-ns:137:TCP,UDP"
    "ldap:389:TCP,UDP"
    "vnc:5900:TCP"
    "vnc-http:5800:TCP"
    "x11:6000:TCP"
    "x11:6001:UDP"
    "dhcp:67,68:UDP"
    "rexec:512:TCP"
    "rlogin:513:TCP"
    "rwho:513:TCP,UDP"
    "smtp:25:TCP"
    "finger:79:TCP"
    "nfs:2049:UDP"
    "http:80:TCP"
    "https:443:TCP"
    "dns:53:TCP,UDP"
    "mysql:3306:TCP"
    "mssql:1433:TCP"
    "postgresql:5432:TCP"
    "oracle:1521:TCP"
)

# Required tools
TOOLS=("nmap" "smbclient" "smbmap" "enum4linux" "msfconsole" "snmpwalk" "smtp-user-enum" "ldapsearch")

# Function to check installed tools
check_tools() {
    echo -e "${BLUE}Checking for required tools...${NC}" | tee -a "$REPORT_FILE"
    INSTALLED_TOOLS=()
    for tool in "${TOOLS[@]}"; do
        if command -v "$tool" &>/dev/null; then
            INSTALLED_TOOLS+=("$tool")
            echo -e "${GREEN}$tool is installed${NC}" | tee -a "$REPORT_FILE"
        else
            echo -e "${YELLOW}Warning: $tool is not installed, skipping related scans${NC}" | tee -a "$REPORT_FILE"
        fi
    done
}

# Function to validate IP or CIDR
validate_input() {
    local input=$1
    # Check for single IP
    if [[ $input =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$ ]]; then
        return 0
    # Check for CIDR
    elif [[ $input =~ ^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/[0-9]{1,2}$ ]]; then
        return 0
    else
        echo -e "${RED}Error: Invalid IP or CIDR format${NC}" | tee -a "$REPORT_FILE"
        exit 1
    fi
}

# Function to calculate CIDR range size
cidr_to_host_count() {
    local cidr=$1
    local prefix=${cidr##*/}
    local host_bits=$((32 - prefix))
    echo $((2 ** host_bits - 2))
}

# Function to format duration
format_duration() {
    local seconds=$1
    local hours=$((seconds / 3600))
    local minutes=$(( (seconds % 3600) / 60 ))
    local secs=$((seconds % 60))
    printf "%02d:%02d:%02d" $hours $minutes $secs
}

# Function to update progress
update_progress() {
    local current_host=$1
    local total_hosts=$2
    local current_service=$3
    local total_services=$4
    local elapsed=$5
    local host_percent=$((current_host * 100 / total_hosts))
    local service_percent=$((current_service * 100 / total_services))
    echo -ne "\r${BLUE}Progress: ${GREEN}$current_host/$total_hosts hosts ($host_percent%), $current_service/$total_services services ($service_percent%) | Elapsed: $(format_duration $elapsed)${NC}"
}

# Function to perform scans
perform_scans() {
    local target=$1
    local start_time=$(date +%s)
    echo -e "${BLUE}Starting scans for $target${NC}" | tee -a "$REPORT_FILE"
    echo "----------------------------------------" | tee -a "$REPORT_FILE"

    # Perform ping scan first
    if [[ " ${INSTALLED_TOOLS[*]} " =~ " nmap " ]]; then
        echo -e "${BLUE}Running ping scan...${NC}" | tee -a "$REPORT_FILE"
        LIVE_HOSTS=$(nmap -sn "$target" -oG - | grep "Up" | awk '{print $2}')
        if [ -z "$LIVE_HOSTS" ]; then
            echo -e "${YELLOW}No live hosts found${NC}" | tee -a "$REPORT_FILE"
            return
        fi
    else
        LIVE_HOSTS="$target"
    fi

    # Count total hosts
    TOTAL_HOSTS=$(echo "$LIVE_HOSTS" | wc -w)
    if [ $TOTAL_HOSTS -eq 0 ]; then
        TOTAL_HOSTS=1
    fi
    TOTAL_SERVICES=10 # Max possible scans: Nmap TCP, UDP, FTP, smbclient, smbmap, enum4linux, msfconsole, snmpwalk, smtp-user-enum, ldapsearch
    CURRENT_HOST=0

    for host in $LIVE_HOSTS; do
        CURRENT_HOST=$((CURRENT_HOST + 1))
        CURRENT_SERVICE=0
        local current_time=$(date +%s)
        local elapsed=$((current_time - start_time))
        echo -e "${GREEN}Host: $host${NC}" | tee -a "$REPORT_FILE"
        echo "----------------------------------------" | tee -a "$REPORT_FILE"

        # Nmap TCP/UDP scans with service-specific plugins
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " nmap " ]]; then
            TCP_PORTS=$(echo "${SERVICES[@]}" | grep -o "[0-9]\+:[0-9]\+:TCP" | cut -d: -f2 | tr ' ' ',')
            UDP_PORTS=$(echo "${SERVICES[@]}" | grep -o "[0-9]\+:[0-9]\+:UDP" | cut -d: -f2 | tr ' ' ',')

            # TCP scan with service enumeration
            if [ -n "$TCP_PORTS" ]; then
                echo -e "${BLUE}Running Nmap TCP scan with plugins...${NC}" | tee -a "$REPORT_FILE"
                nmap -sS -p "$TCP_PORTS" --open -sV --script="banner,(telnet* or ssh* or ldap* or vnc* or http* or https* or smtp* or finger* or mysql* or mssql* or postgresql* or oracle*) and not (brute or dos)" "$host" -oN - >> "$REPORT_FILE"
                CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
                current_time=$(date +%s)
                elapsed=$((current_time - start_time))
                update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
            fi

            # UDP scan with service enumeration
            if [ -n "$UDP_PORTS" ]; then
                echo -e "${BLUE}Running Nmap UDP scan with plugins...${NC}" | tee -a "$REPORT_FILE"
                nmap -sU -p "$UDP_PORTS" --open -sV --script="banner,(snmp* or tftp* or ntp* or rpc* or netbios* or ldap* or dns* or nfs*) and not (brute or dos)" "$host" -oN - >> "$REPORT_FILE"
                CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
                current_time=$(date +%s)
                elapsed=$((current_time - start_time))
                update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
            fi

            # FTP anonymous login check
            if nmap -p 21 "$host" | grep -q "open"; then
                echo -e "${BLUE}Checking FTP anonymous login...${NC}" | tee -a "$REPORT_FILE"
                nmap --script ftp-anon -p 21 "$host" -oN - >> "$REPORT_FILE"
                CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
                current_time=$(date +%s)
                elapsed=$((current_time - start_time))
                update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
            fi
        fi

        # SMB checks
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " smbclient " ]] && nmap -p 445,139 "$host" | grep -q "open"; then
            echo -e "${BLUE}Running smbclient checks...${NC}" | tee -a "$REPORT_FILE"
            smbclient -L //"$host" -N >> "$REPORT_FILE" 2>&1
            CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
            current_time=$(date +%s)
            elapsed=$((current_time - start_time))
            update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
        fi
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " smbmap " ]] && nmap -p 445,139 "$host" | grep -q "open"; then
            echo -e "${BLUE}Running smbmap checks...${NC}" | tee -a "$REPORT_FILE"
            smbmap -H "$host" >> "$REPORT_FILE" 2>&1
            CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
            current_time=$(date +%s)
            elapsed=$((current_time - start_time))
            update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
        fi
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " enum4linux " ]] && nmap -p 445,139 "$host" | grep -q "open"; then
            echo -e "${BLUE}Running enum4linux...${NC}" | tee -a "$REPORT_FILE"
            enum4linux -a "$host" >> "$REPORT_FILE" 2>&1
            CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
            current_time=$(date +%s)
            elapsed=$((current_time - start_time))
            update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
        fi

        # Metasploit exploit check
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " msfconsole " ]] && [[ " ${INSTALLED_TOOLS[*]} " =~ " nmap " ]]; then
            echo -e "${BLUE}Running Metasploit exploit check...${NC}" | tee -a "$REPORT_FILE"
            SERVICES_FOUND=$(nmap -sV -p "$TCP_PORTS,$UDP_PORTS" "$host" -oG - | grep "open" | awk '{print $4}' | tr '/' ' ')
            for service in $SERVICES_FOUND; do
                msfconsole -q -x "search type:exploit $service; exit" >> "$REPORT_FILE" 2>&1
            done
            CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
            current_time=$(date +%s)
            elapsed=$((current_time - start_time))
            update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
        fi

        # SNMP enumeration
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " snmpwalk " ]] && nmap -p 161 -sU "$host" | grep -q "open"; then
            echo -e "${BLUE}Running SNMP enumeration...${NC}" | tee -a "$REPORT_FILE"
            snmpwalk -v1 -c public "$host" >> "$REPORT_FILE" 2>&1
            CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
            current_time=$(date +%s)
            elapsed=$((current_time - start_time))
            update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
        fi

        # SMTP enumeration
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " smtp-user-enum " ]] && nmap -p 25 "$host" | grep -q "open"; then
            echo -e "${BLUE}Running SMTP user enumeration...${NC}" | tee -a "$REPORT_FILE"
            smtp-user-enum -M VRFY -U /usr/share/wordlists/users.txt -t "$host" >> "$REPORT_FILE" 2>&1
            CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
            current_time=$(date +%s)
            elapsed=$((current_time - start_time))
            update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
        fi

        # LDAP enumeration
        if [[ " ${INSTALLED_TOOLS[*]} " =~ " ldapsearch " ]] && nmap -p 389 "$host" | grep -q "open"; then
            echo -e "${BLUE}Running LDAP enumeration...${NC}" | tee -a "$REPORT_FILE"
            ldapsearch -x -H ldap://"$host" -s base >> "$REPORT_FILE" 2>&1
            ldapsearch -x -H ldap://"$host" -b "" -s sub "(objectclass=*)" >> "$REPORT_FILE" 2>&1
            CURRENT_SERVICE=$((CURRENT_SERVICE + 1))
            current_time=$(date +%s)
            elapsed=$((current_time - start_time))
            update_progress $CURRENT_HOST $TOTAL_HOSTS $CURRENT_SERVICE $TOTAL_SERVICES $elapsed
        fi

        echo "----------------------------------------" | tee -a "$REPORT_FILE"
    done
    local end_time=$(date +%s)
    local total_duration=$((end_time - start_time))
    echo -e "\n${GREEN}Scan completed in $(format_duration $total_duration). Report saved to $REPORT_FILE${NC}" | tee -a "$REPORT_FILE"
}

# Main script
if [ $# -ne 1 ]; then
    echo -e "${RED}Usage: $0 <IP or CIDR>${NC}"
    exit 1
fi

# Initialize report file
echo "Scan Report - $(date)" > "$REPORT_FILE"

# Check tools
check_tools

# Validate input
validate_input "$1"

# Perform scans
perform_scans "$1"
